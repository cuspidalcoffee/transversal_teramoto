Let us explain how to confirm if a given semi-algebraic set $V \left( E \right) \setminus V \left( N \right)$ defined by the ideals $E$ and $N$ is a smooth manifold by using the constant rank theorem by taking semi-algebraic sets appearing in the classificaiton of divergent diagram as examples. In the classification, we got the following list of semi-algebraic sets: 

| # | Semi-Algebraic Set |
| - |------------------- |
| 1 | $c_1 = c_2 = c_3 = c_4 = 0$ |
| 2 | $c_1 c_4 - c_2 c_3 \neq 0$ |
| 3 | $c_1 c_4 - c_2 c_3 = 0$ and ($c_2 c_4 \neq 0$ or $c_1 c_4 \neq 0$ or $c_1 c_3 \neq 0$)  |
| 4 | $c_2 c_4 = c_1 c_4 = c_2 c_3 = c_1 c_3 = 0$ and ($c_1 \neq 0$ or $c_2 \neq 0$ or $c_3 \neq 0$ or $c_4 \neq 0$)  |

Let $E$ and $N$ be ideal defining a semi-algebraic set. For example, the fourth semi-algebraic set can be written as $V \left( E \right) \setminus V \left( N \right)$ where 

$$E = \langle c_2 c_4, c_1 c_4, c_2 c_3, c_1 c_3 \rangle$$

and 

$$N = \langle c_1, c_2, c_3, c_4 \rangle$$

where $\langle \cdots \rangle$ is the ideal generated by $\cdots$ in $\mathbb{R} \left[ c_1, c_2, c_3, c_4 \right]$. In the source code ([check_smoothness.exe](check_smoothness.exe)), you can check the semi-algebraic sets in the list are smooth manifolds by using the constant rank theorem. 

Let $\mathbb{R} \left[ c \right]$ be a polynomial ring with variables $c = \left( c_1, \ldots, c_m \right)$ with the coefficient field $\mathbb{R}$ and $E$, $N$ be ideals in $\mathbb{R} \left[ c \right]$. Let $h_1, \ldots, h_l$ be generators of $E$. Let $dE$ be the $l \times m$ jacobi matrix defined as:

$$ dE = 
\begin{pmatrix}
\frac{\partial h_1}{\partial c_1} & \cdots & \frac{\partial h_1}{\partial c_m} \\
\vdots & \ddots & \vdots \\
\frac{\partial h_l}{\partial c_1} & \cdots & \frac{\partial h_l}{\partial c_m}
\end{pmatrix}.
$$

In the following line in the source code, 
```Singular
list L = gauss_elimination_gb(E,N,dE);
```
Gaussian elimination is done in the parameter range $V \left( E \right) \setminus V \left( N \right)$.

> ```Singular
> reduce_mixed_with_E(list X, vector p, module Nc, list Q, ideal E)
> ```
> | Parameter | Description |
> | --------- | ----------- |
> | `X` | family of variables (Note that X[i-1] = $X_i$ in the paper) |
> | `p` | input vector to be reduced |
> | `Nc` | local cohomology of $M_1$ |
> | `Q` | list of mixed standard basis $S^{(j+1)}$ for $j \ge 1$ |
> | `E` | ideal in the polynomial ring of parameters (`Nc` and `Q` is defined on the parameter range $V(E) \setminus V(N)$ |
> #### Output
> - the reduced normal form of `p`, that is, $\mathrm{NF} \_{\textnormal{tail}} \left( p \middle| \left( S^{\left( j \right)} \right)_{j \in J} \right)$ in the paper
> #### Example
> Suppose `p` is a vector you want to reduce by the comprehensive standard system of the $i$-th parameter range $V(E_i) \setminus V(N_i)$, that is, `Lg[i]`. You can compute that by the command `reduce_mixed_with_E(X,p,Lg[i][3][3],Lg[i][4],Lg[i][3][1])`.

